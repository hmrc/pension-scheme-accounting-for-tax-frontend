@*
 * Copyright 2024 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import viewmodels.{Hint, InputSearchLabelViewModel}

@this(
    layout: templates.Layout,
    govukLabel: GovukLabel
)

@(
    label: InputSearchLabelViewModel
    hint: String,
    id: String,
    describedBy: String,
    hintId: String,
    hint: Hint,
    errorMessage: String

)(implicit messages: Messages)

@hintId = {
    @if(hint) {
        id + '-hint'
    }
}

@describedBy = {
    @if(hint.length > 0) {
        @if(describedBy.length > 0) {
            describedBy + ' ' + hintId
        } else {
            hintId
        }
    }
}

@errorId = { params.id + '-error' }


<div class="govuk-form-group {%- if params.errorMessage %} govuk-form-group--error{% endif %} {%- if params.formGroup.classes %} {{ params.formGroup.classes }}{% endif %}">
     @govukLabel(
        content = label.text,
        classes = label.classes,
        isPageHeading = label.isPageHeading,
        attributes = label.attributes,
        forAttr = label.id
     )

     @if params.hint %}
        @govukHint(
           id = hintId,
           classes: hint.classes,
           attributes: hint.attributes,
           content: hint.text
        )
     }

    @if(errorMessage) {
        {{ govukErrorMessage({
        id: errorId,
        classes: params.errorMessage.classes,
        attributes: params.errorMessage.attributes,
        html: params.errorMessage.html,
        text: params.errorMessage.text,
        visuallyHiddenText: params.errorMessage.visuallyHiddenText
        })
    }
    <input class="govuk-input {%- if params.classes %} {{ params.classes }}{% endif %} {%- if params.errorMessage %} govuk-input--error{% endif %}" id="{{ params.id }}" name="{{ params.name }}" type="{{ params.type | default('text') }}"
           {%- if params.value %} value="{{ params.value}}"{% endif %}
           {%- if describedBy %} aria-describedby="{{ describedBy }}"{% endif %}
           {%- if params.autocomplete %} autocomplete="{{ params.autocomplete}}"{% endif %}
           {%- if params.pattern %} pattern="{{ params.pattern }}"{% endif %}
           {%- if params.inputmode %} inputmode="{{ params.inputmode }}"{% endif %}
           {%- for attribute, value in params.attributes %} {{ attribute }}="{{ value }}"{% endfor -%}>
    {% if params.searchButton %}
    {% set describedBy = describedBy + ' ' + buttonId if describedBy else errorId %}
    {{ govukButton({
    classes: params.searchButton.classes,
    attributes: params.searchButton.attributes,
    html: params.searchButton.html,
    text: params.searchButton.text,
    visuallyHiddenText: params.searchButton.visuallyHiddenText
    }) | indent(2) | trim }}
    {% endif %}
</div>

