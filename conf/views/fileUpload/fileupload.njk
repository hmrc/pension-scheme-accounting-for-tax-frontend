{% extends "includes/layout.njk" %}

{% from "macros/title.njk"  import title %}
{% from "govuk/components/radios/macro.njk" import govukRadios %}
{% from "govuk/components/button/macro.njk" import govukButton %}
{% from "govuk/components/file-upload/macro.njk" import govukFileUpload %}
{% from "govuk/components/details/macro.njk" import govukDetails %}

{% block pageTitle %}
  {{ title(messages("fileupload.fileupload.title", chargeTypeText)) }}
{% endblock %}
{% set details %}
    {% include "partials/uploadDetails/" + chargeType + ".njk" %}
{% endset %}

{% block mainContent %}

    <div class="govuk-grid-row">
          <div class="govuk-grid-column-two-thirds">

            <h1 class="govuk-heading-xl">
              {{ messages("fileupload.fileupload.heading", chargeTypeText) }}
            </h1>

            <form action="{{ viewModel.submitUrl }}" method="post" enctype="multipart/form-data" class="govuk-body">

            {% for field in formFields %}
                <input type="hidden" name="{{field[0]}}" value="{{field[1]}}"/>
            {% endfor %}

            <div class="">
                <div class="form-group">

                    <div class="form-control-wrapper">

                        {{ govukDetails({
                          summaryText: messages("fileupload.upload.details.summary"),
                          html:details
                        }) }}

                        <div class="govuk-inset-text">
                           <p class="govuk-body govuk-!-margin-bottom-0">{{ messages("fileupload.upload.inset.text1") }}</p>
                           <p class="govuk-body govuk-!-margin-bottom-0">{{ messages("fileupload.upload.inset.text2") }}</p>
                        </div>

                        {% if error == null %}
                        {{ govukFileUpload({
                              id: "file-input",
                              name: "file",
                              attributes: {
                                "accept": ".csv,application/csv"
                                    },
                              label: {
                                text: messages("inputSelection.radio.fileUploadInput")
                              }
                        }) }}

                        {% else %}

                        {{ govukFileUpload({
                          id: "file-input",
                          name: "file",
                           attributes: {
                                                          "accept": ".csv,application/csv"
                                                              },
                          label: {
                            text: messages("inputSelection.radio.fileUploadInput")
                          },
                          errorMessage: {
                            text: messages(error, maxFileUploadSize)
                          }
                        }) }}

                        {% endif %}
                    </div>
                </div>
            </div>

             {{ govukButton({
             text: messages("site.continue"),
             attributes: {id: "submit"}
           }) }}
          </div>
        </div>

         </form>

      <p class="govuk-body"><a href="{{viewModel.returnUrl}}" class="govuk-link"> {{ messages("return.to.link", viewModel.schemeName) }}</a>
      </p>
{% endblock %}
